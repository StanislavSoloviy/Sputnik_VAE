WARNING:tensorflow:AutoGraph could not transform <bound method NeuralNetwork.sample of <tensorflow.python.eager.polymorphic_function.tf_method_target.TfMethodTarget object at 0x000002769E3AA020>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING:tensorflow:AutoGraph could not transform <bound method NeuralNetwork.encode of <neural_network.NeuralNetwork object at 0x00000276EA83BF70>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING:tensorflow:AutoGraph could not transform <bound method NeuralNetwork.decode of <neural_network.NeuralNetwork object at 0x00000276EA83BF70>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
Epoch: 1, Test set ELBO: -114760.53125, time elapse for current epoch: 92.94404315948486
C:\Users\motom\Desktop\Python\Sputnik_VAE\venv\lib\site-packages\keras\src\engine\training.py:3000: UserWarning: You are saving your model as an HDF5 file via `model.save()`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')`.
  saving_api.save_model(
WARNING:tensorflow:Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
WARNING:tensorflow:Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
Модель обучена
Модель сохранена
Время на обучение модели 120.67677910003113
tfp.distributions.Normal("Normal", batch_shape=[], event_shape=[], dtype=float32)
tf.Tensor(
[-1.6448536  -1.6069207  -1.5711685  -1.5373187  -1.5051444  -1.4744562
 -1.4450977  -1.4169338  -1.3898511  -1.3637516  -1.3385491  -1.3141692
 -1.2905463  -1.2676227  -1.2453462  -1.2236714  -1.2025566  -1.1819646
 -1.1618619  -1.1422184  -1.1230059  -1.1041992  -1.0857751  -1.0677124
 -1.0499915  -1.0325946  -1.0155044  -0.9987056  -0.98218447 -0.96592695
 -0.9499208  -0.93415433 -0.91861683 -0.903298   -0.88818824 -0.8732787
 -0.8585607  -0.84402627 -0.82966805 -0.815479   -0.80145216 -0.7875812
 -0.77386016 -0.7602834  -0.74684536 -0.7335408  -0.72036463 -0.70731264
 -0.69438    -0.68156236 -0.66885585 -0.6562563  -0.64376026 -0.63136375
 -0.6190636  -0.6068564  -0.594739   -0.5827083  -0.5707613  -0.55889523
 -0.5471074  -0.5353951  -0.5237557  -0.51218694 -0.5006863  -0.48925152
 -0.47788027 -0.46657056 -0.45532012 -0.44412714 -0.43298945 -0.42190528
 -0.4108726  -0.39988983 -0.388955   -0.37806657 -0.36722267 -0.35642186
 -0.34566242 -0.3349429  -0.32426167 -0.31361738 -0.30300844 -0.29243353
 -0.2818913  -0.27138016 -0.260899   -0.2504464  -0.24002111 -0.22962181
 -0.21924733 -0.20889634 -0.19856775 -0.18826023 -0.17797275 -0.16770399
 -0.15745294 -0.14721836 -0.13699925 -0.12679435 -0.11660271 -0.1064231
 -0.09625458 -0.086096   -0.07594622 -0.06580433 -0.05566914 -0.04553973
 -0.03541492 -0.02529381 -0.01517522 -0.00505826  0.00505819  0.01517522
  0.02529381  0.03541499  0.04553965  0.05566914  0.06580433  0.07594629
  0.08609592  0.09625458  0.10642318  0.11660264  0.12679435  0.13699925
  0.14721844  0.15745287  0.16770399  0.17797275  0.1882603   0.19856767
  0.20889634  0.21924733  0.22962189  0.24002104  0.2504464   0.260899
  0.27138025  0.2818912   0.29243353  0.3030085   0.3136173   0.32426167
  0.3349429   0.3456625   0.3564218   0.36722267  0.37806657  0.38895506
  0.39988977  0.4108726   0.42190528  0.43298954  0.44412705  0.45532012
  0.46657056  0.47788036  0.48925143  0.5006863   0.51218694  0.52375567
  0.5353951   0.5471074   0.55889535  0.57076126  0.5827083   0.594739
  0.6068565   0.61906356  0.63136375  0.64376026  0.6562564   0.6688558
  0.68156236  0.69438     0.70731276  0.72036463  0.7335408   0.74684536
  0.7602833   0.77386016  0.7875812   0.80145216  0.8154788   0.82966805
  0.84402627  0.8585607   0.8732785   0.88818824  0.903298    0.918617
  0.93415433  0.9499208   0.96592695  0.9821845   0.9987056   1.0155044
  1.0325946   1.0499915   1.0677124   1.0857751   1.1041992   1.1230059
  1.1422184   1.1618619   1.1819646   1.2025564   1.2236712   1.2453462
  1.2676227   1.2905463   1.3141692   1.3385491   1.3637516   1.3898511
  1.4169338   1.4450977   1.4744565   1.5051444   1.5373187   1.5711685
  1.6069205   1.6448536 ], shape=(224,), dtype=float32)
tf.Tensor(
[-1.6448536  -1.6069207  -1.5711685  -1.5373187  -1.5051444  -1.4744562
 -1.4450977  -1.4169338  -1.3898511  -1.3637516  -1.3385491  -1.3141692
 -1.2905463  -1.2676227  -1.2453462  -1.2236714  -1.2025566  -1.1819646
 -1.1618619  -1.1422184  -1.1230059  -1.1041992  -1.0857751  -1.0677124
 -1.0499915  -1.0325946  -1.0155044  -0.9987056  -0.98218447 -0.96592695
 -0.9499208  -0.93415433 -0.91861683 -0.903298   -0.88818824 -0.8732787
 -0.8585607  -0.84402627 -0.82966805 -0.815479   -0.80145216 -0.7875812
 -0.77386016 -0.7602834  -0.74684536 -0.7335408  -0.72036463 -0.70731264
 -0.69438    -0.68156236 -0.66885585 -0.6562563  -0.64376026 -0.63136375
 -0.6190636  -0.6068564  -0.594739   -0.5827083  -0.5707613  -0.55889523
 -0.5471074  -0.5353951  -0.5237557  -0.51218694 -0.5006863  -0.48925152
 -0.47788027 -0.46657056 -0.45532012 -0.44412714 -0.43298945 -0.42190528
 -0.4108726  -0.39988983 -0.388955   -0.37806657 -0.36722267 -0.35642186
 -0.34566242 -0.3349429  -0.32426167 -0.31361738 -0.30300844 -0.29243353
 -0.2818913  -0.27138016 -0.260899   -0.2504464  -0.24002111 -0.22962181
 -0.21924733 -0.20889634 -0.19856775 -0.18826023 -0.17797275 -0.16770399
 -0.15745294 -0.14721836 -0.13699925 -0.12679435 -0.11660271 -0.1064231
 -0.09625458 -0.086096   -0.07594622 -0.06580433 -0.05566914 -0.04553973
 -0.03541492 -0.02529381 -0.01517522 -0.00505826  0.00505819  0.01517522
  0.02529381  0.03541499  0.04553965  0.05566914  0.06580433  0.07594629
  0.08609592  0.09625458  0.10642318  0.11660264  0.12679435  0.13699925
  0.14721844  0.15745287  0.16770399  0.17797275  0.1882603   0.19856767
  0.20889634  0.21924733  0.22962189  0.24002104  0.2504464   0.260899
  0.27138025  0.2818912   0.29243353  0.3030085   0.3136173   0.32426167
  0.3349429   0.3456625   0.3564218   0.36722267  0.37806657  0.38895506
  0.39988977  0.4108726   0.42190528  0.43298954  0.44412705  0.45532012
  0.46657056  0.47788036  0.48925143  0.5006863   0.51218694  0.52375567
  0.5353951   0.5471074   0.55889535  0.57076126  0.5827083   0.594739
  0.6068565   0.61906356  0.63136375  0.64376026  0.6562564   0.6688558
  0.68156236  0.69438     0.70731276  0.72036463  0.7335408   0.74684536
  0.7602833   0.77386016  0.7875812   0.80145216  0.8154788   0.82966805
  0.84402627  0.8585607   0.8732785   0.88818824  0.903298    0.918617
  0.93415433  0.9499208   0.96592695  0.9821845   0.9987056   1.0155044
  1.0325946   1.0499915   1.0677124   1.0857751   1.1041992   1.1230059
  1.1422184   1.1618619   1.1819646   1.2025564   1.2236712   1.2453462
  1.2676227   1.2905463   1.3141692   1.3385491   1.3637516   1.3898511
  1.4169338   1.4450977   1.4744565   1.5051444   1.5373187   1.5711685
  1.6069205   1.6448536 ], shape=(224,), dtype=float32)
[[-1.6448536 -1.6448536]]
Traceback (most recent call last):
  File "C:\Users\motom\Desktop\Python\Sputnik_VAE\main.py", line 91, in <module>
    plot_latent_images(model, 5)
  File "C:\Users\motom\Desktop\Python\Sputnik_VAE\main.py", line 41, in plot_latent_images
    digit = tf.reshape(x_decoded[0], (digit_size, digit_size))
  File "C:\Users\motom\Desktop\Python\Sputnik_VAE\venv\lib\site-packages\tensorflow\python\util\traceback_utils.py", line 153, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\motom\Desktop\Python\Sputnik_VAE\venv\lib\site-packages\tensorflow\python\eager\execute.py", line 53, in quick_execute
    tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
tensorflow.python.framework.errors_impl.InvalidArgumentError: {{function_node __wrapped__Reshape_device_/job:localhost/replica:0/task:0/device:CPU:0}} Input to reshape is a tensor with 150528 values, but the requested shape has 50176 [Op:Reshape]